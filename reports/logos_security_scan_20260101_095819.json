{"version":"1.139.0","results":[{"check_id":"yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","path":"deploy/kubernetes/deployment.yaml","start":{"line":24,"col":9,"offset":539},"end":{"line":24,"col":13,"offset":543},"extra":{"metavars":{"$NAME":{"start":{"line":24,"col":9,"offset":539},"end":{"line":24,"col":13,"offset":543},"abstract_content":"name"},"$CONTAINER":{"start":{"line":24,"col":15,"offset":545},"end":{"line":24,"col":21,"offset":551},"abstract_content":"qdrant"}},"message":"In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.","fix":"securityContext:\n          allowPrivilegeEscalation: false\n        name","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation","https://kubernetes.io/docs/tasks/configure-pod-container/security-context/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["kubernetes"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","shortlink":"https://sg.run/eleR","semgrep.dev":{"rule":{"origin":"community","r_id":47276,"rule_id":"WAU5J6","rv_id":947050,"url":"https://semgrep.dev/playground/r/e1T9vzn/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","version_id":"e1T9vzn"}}},"severity":"WARNING","fingerprint":"fc69a110886475f0934b82a80347f748f70e27dde2f2e64e65a901f8a0cb041aaa9dc436105c0a4e2fe9fe8159bf4a029a0677d18d2af82a1837603a3abd8169_0","lines":"      - name: qdrant","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","path":"deploy/kubernetes/deployment.yaml","start":{"line":64,"col":9,"offset":1532},"end":{"line":64,"col":13,"offset":1536},"extra":{"metavars":{"$NAME":{"start":{"line":64,"col":9,"offset":1532},"end":{"line":64,"col":13,"offset":1536},"abstract_content":"name"},"$CONTAINER":{"start":{"line":64,"col":15,"offset":1538},"end":{"line":64,"col":24,"offset":1547},"abstract_content":"logos-mcp"}},"message":"In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.","fix":"securityContext:\n          allowPrivilegeEscalation: false\n        name","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation","https://kubernetes.io/docs/tasks/configure-pod-container/security-context/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["kubernetes"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","shortlink":"https://sg.run/eleR","semgrep.dev":{"rule":{"origin":"community","r_id":47276,"rule_id":"WAU5J6","rv_id":947050,"url":"https://semgrep.dev/playground/r/e1T9vzn/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","version_id":"e1T9vzn"}}},"severity":"WARNING","fingerprint":"a3a5b5dc2ebce770ff5e207fbed61a764a29f349031fcb62ad36ef911b26fe1443930b705fbeef6ae88488e8b9d106ebedb029e75f4e4aa26b7afb87e60bd18f_0","lines":"      - name: logos-mcp","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","path":"deploy/kubernetes/statefulset.yaml","start":{"line":28,"col":9,"offset":680},"end":{"line":28,"col":13,"offset":684},"extra":{"metavars":{"$NAME":{"start":{"line":28,"col":9,"offset":680},"end":{"line":28,"col":13,"offset":684},"abstract_content":"name"},"$CONTAINER":{"start":{"line":28,"col":15,"offset":686},"end":{"line":28,"col":21,"offset":692},"abstract_content":"qdrant"}},"message":"In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.","fix":"securityContext:\n          allowPrivilegeEscalation: false\n        name","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation","https://kubernetes.io/docs/tasks/configure-pod-container/security-context/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["kubernetes"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","shortlink":"https://sg.run/eleR","semgrep.dev":{"rule":{"origin":"community","r_id":47276,"rule_id":"WAU5J6","rv_id":947050,"url":"https://semgrep.dev/playground/r/e1T9vzn/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","version_id":"e1T9vzn"}}},"severity":"WARNING","fingerprint":"892680b70df8ea3911a0cdbd97a64253c85dc019aaf13ae482b066087f01610ccfc4f3055d3cb0d3532f8b26674a8e810905a9eba1baeae1a70586a08c3692ad_0","lines":"      - name: qdrant","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":"Syntax error","message":"Syntax error at line src/config.py:59:\n missing element","path":"src/config.py"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line deploy/kubernetes/helm/templates/deployment.yaml:6:\n (approximate error location; error nearby after) error calling parser: did not find expected node content character 0 position 0 returned: 0","path":"deploy/kubernetes/helm/templates/deployment.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line deploy/kubernetes/helm/templates/pvc.yaml:1:\n (approximate error location; error nearby after) error calling parser: did not find expected node content character 0 position 0 returned: 0","path":"deploy/kubernetes/helm/templates/pvc.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line deploy/kubernetes/helm/templates/secret.yaml:6:\n (approximate error location; error nearby after) error calling parser: did not find expected node content character 0 position 0 returned: 0","path":"deploy/kubernetes/helm/templates/secret.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line deploy/kubernetes/helm/templates/service.yaml:6:\n (approximate error location; error nearby after) error calling parser: did not find expected node content character 0 position 0 returned: 0","path":"deploy/kubernetes/helm/templates/service.yaml"}],"paths":{"scanned":["Dockerfile","cli/README.md","cli/__init__.py","cli/cli.py","cli/llm_client.py","cli/mcp_client.py","cli/requirements.txt","cli/setup.py","deploy/docker/README.md","deploy/docker/docker-compose.portainer.yml","deploy/docker/docker-compose.yml","deploy/docker/portainer-env-template.txt","deploy/kubernetes/README.md","deploy/kubernetes/configmap.yaml","deploy/kubernetes/deployment.yaml","deploy/kubernetes/helm/Chart.yaml","deploy/kubernetes/helm/templates/_helpers.tpl","deploy/kubernetes/helm/templates/deployment.yaml","deploy/kubernetes/helm/templates/pvc.yaml","deploy/kubernetes/helm/templates/secret.yaml","deploy/kubernetes/helm/templates/service.yaml","deploy/kubernetes/helm/values.yaml","deploy/kubernetes/kustomization.yaml","deploy/kubernetes/namespace.yaml","deploy/kubernetes/pvc.yaml","deploy/kubernetes/secrets.yaml","deploy/kubernetes/service.yaml","deploy/kubernetes/statefulset.yaml","src/__init__.py","src/config.py","src/engine/__init__.py","src/engine/document_processor.py","src/engine/embedder.py","src/engine/vector_store.py","src/llm/__init__.py","src/llm/client.py","src/logging_config.py","src/main.py","src/memory/__init__.py","src/memory/letter_protocol.py","src/personality/__init__.py","src/personality/constitution.py","src/personality/prompt_manager.py","src/tools/__init__.py","src/tools/file_tools.py","src/tools/memory_tools.py","src/tools/query_tools.py"]},"time":{"rules":[],"rules_parse_time":9.864294052124023,"profiling_times":{"config_time":19.563010454177856,"core_time":19.28952169418335,"ignores_time":0.004174470901489258,"total_time":38.85762977600098},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":12.321419715881348,"per_file_time":{"mean":0.0905986743814805,"std_dev":0.058103039377518755},"very_slow_stats":{"time_ratio":0.1365462662573254,"count_ratio":0.007352941176470588},"very_slow_files":[{"fpath":"src/tools/file_tools.py","ftime":1.6824438571929932}]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9814436903801433,"rules_selected_ratio":0.06440130985714963,"rules_matched_ratio":0.06440130985714963},"targets":[],"total_bytes":0,"max_memory_bytes":8290425024},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[]}